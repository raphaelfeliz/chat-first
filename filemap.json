{
  "src/main.js": {
    "path": "src/main.js",
    "tags": ["core", "initialization", "chat", "configurator"],
    "purpose": "Main entry point of the application. Initializes Firebase, the chat session, and the product configurator.",
    "summary": "This file acts as the central orchestrator. It sets up the Firebase connection, creates or restores a chat session from Firestore, and dynamically loads the product configurator engine. It is responsible for the initial setup and bringing all the major components online.",
    "imports": [
      "./config/firebase.js",
      "./state/appState.js",
      "./chat/chatUi.js",
      "./configurator/configuratorEngine.js"
    ],
    "functions": {
      "private": [],
      "exports": []
    }
  },
  "src/chat/chatUi.js": {
    "path": "src/chat/chatUi.js",
    "tags": ["chat", "ui", "dom", "ai"],
    "purpose": "Manages the chat UI, handles user input, and initiates the AI response flow.",
    "summary": "This file is responsible for all DOM manipulations related to the chat. It renders messages, handles the user input form, and, crucially, calls the AI service (`gemini.js`) upon submission. It then passes the AI's structured response to the `orchestrator.js` to trigger state updates.",
    "imports": [
      "../utils/sanitizers.js",
      "../utils/domRefs.js",
      "../services/gemini.js",
      "../state/orchestrator.js"
    ],
    "functions": {
      "private": [
        "createMessageElement",
        "scrollToBottom"
      ],
      "exports": [
        "appendBatch",
        "bindUserMessageHandler",
        "createUserMessageListener",
        "showTypingIndicator",
        "hideTypingIndicator"
      ]
    }
  },
  "src/config/firebase.js": {
    "path": "src/config/firebase.js",
    "tags": ["config", "firebase"],
    "purpose": "Initializes and provides access to the Firebase Firestore instance.",
    "summary": "Contains the Firebase configuration object and the initialization logic. It exports getter functions for the core Firebase services, making them available throughout the application.",
    "imports": [],
    "functions": {
      "private": [],
      "exports": [
        "init",
        "getDb",
        "getAuth"
      ]
    }
  },
  "src/configurator/configuratorEngine.js": {
    "path": "src/configurator/configuratorEngine.js",
    "tags": ["configurator", "logic", "ui", "state-subscriber"],
    "purpose": "Core logic for the product configurator. Renders the UI based on the global state.",
    "summary": "The brain of the product configurator. It subscribes to the global `appState`. When the state changes (either by user click or by an AI update), this engine re-renders the UI, determining which question to ask next based on the current product choices.",
    "imports": [
      "../state/appState.js",
      "./productCatalog.js"
    ],
    "functions": {
      "private": [
        "getProductField",
        "calculateNextSelections",
        "applyFilters",
        "getUniqueOptions",
        "runFacetLoop",
        "createOptionCard",
        "createProductCard",
        "renderEngineState",
        "renderLatestState"
      ],
      "exports": [
        "init"
      ]
    }
  },
  "src/configurator/productCatalog.js": {
    "path": "src/configurator/productCatalog.js",
    "tags": ["configurator", "data"],
    "purpose": "Contains the static product data for the configurator.",
    "summary": "This file exports a single constant, `PRODUCT_CATALOG`, which is an array of all possible product objects. It also exports `FACET_ORDER`, which defines the logical sequence of questions in the configurator.",
    "imports": [],
    "functions": {
      "private": [],
      "exports": [
        "FACET_ORDER",
        "PRODUCT_CATALOG"
      ]
    }
  },
  "src/services/gemini.js": {
    "path": "src/services/gemini.js",
    "tags": ["services", "ai", "gemini", "api-client"],
    "purpose": "Client-side service to communicate with the backend AI.",
    "summary": "This module acts as the API client for the backend Google Cloud Function. It takes a user's text prompt, sends it via a `fetch` request, and returns the structured JSON response from the Gemini-powered endpoint.",
    "imports": [],
    "functions": {
      "private": [],
      "exports": [
        "getAiResponse"
      ]
    }
  },
  "src/state/appState.js": {
    "path": "src/state/appState.js",
    "tags": ["state", "core", "firestore"],
    "purpose": "Global state management for the entire application.",
    "summary": "The single source of truth. It manages the `product-choice` and `user` data, persists the entire state to a Firestore document, and notifies subscribed modules of any changes using a pub/sub pattern. This ensures a consistent and persistent user experience.",
    "imports": [
      "../config/firebase.js"
    ],
    "functions": {
      "private": [
        "_persistState",
        "_notifySubscribers"
      ],
      "exports": [
        "getState",
        "subscribe",
        "updateProductChoice",
        "updateUserData",
        "initializeAppState"
      ]
    }
  },
  "src/state/orchestrator.js": {
    "path": "src/state/orchestrator.js",
    "tags": ["state", "ai", "translator"],
    "purpose": "Translates AI responses and triggers state updates.",
    "summary": "This crucial module sits between the AI service and the global state. It receives the structured JSON from `gemini.js`, inspects the `target` (e.g., 'product-choice'), translates the AI's payload schema to the application's state schema, and then calls the appropriate update function in `appState.js`.",
    "imports": [
      "./appState.js"
    ],
    "functions": {
      "private": [
        "_translateProductChoice"
      ],
      "exports": [
        "handleAiResponse"
      ]
    }
  },
  "src/utils/domRefs.js": {
    "path": "src/utils/domRefs.js",
    "tags": ["utilities", "dom"],
    "purpose": "Caches and provides references to key DOM elements.",
    "summary": "A simple utility to get and cache references to frequently accessed DOM elements. This avoids repeated `getElementById` calls, slightly improving performance and centralizing element selection.",
    "imports": [],
    "functions": {
      "private": [],
      "exports": [
        "get"
      ]
    }
  },
  "src/utils/sanitizers.js": {
    "path": "src/utils/sanitizers.js",
    "tags": ["utilities", "security"],
    "purpose": "Provides functions for sanitizing data.",
    "summary": "Contains utility functions for data sanitization. The primary function, `escapeText`, is used to prevent XSS attacks by escaping HTML characters in user-provided text before it's rendered in the DOM.",
    "imports": [],
    "functions": {
      "private": [],
      "exports": [
        "escapeText"
      ]
    }
  },
  "main.py": {
    "path": "main.py",
    "tags": ["backend", "cloud-function", "ai", "gemini"],
    "purpose": "Serverless backend that queries the Gemini Large Language Model.",
    "summary": "A Python-based Google Cloud Function that serves as the application's AI backend. It receives a user prompt, wraps it in a larger, engineered prompt that instructs the model to return structured JSON, and then calls the Gemini API. It is the core of the natural language processing capability.",
    "imports": [
      "functions_framework",
      "json",
      "os",
      "google.generativeai"
    ],
    "functions": {
      "private": [],
      "exports": [
        "gemini_endpoint"
      ]
    }
  }
}